{% extends "accounts/admin/base.html" %}
{% block content %}
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{font-family:Poppins;background:#f1f5f9}

.dashboard{
padding:30px;
}

.topbar{
display:flex;
justify-content:space-between;
align-items:center;
margin-bottom:25px;
}

.stats{
display:grid;
grid-template-columns:repeat(3,1fr);
gap:20px;
margin-bottom:25px;
}

.stat{
background:white;
border-radius:20px;
padding:25px;
text-align:center;
box-shadow:0 20px 40px rgba(0,0,0,.08);
transition:.4s;
}

.stat:hover{
transform:translateY(-10px) scale(1.02);
}

.material-grid{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(250px,1fr));
gap:25px;
}

.card{
background:white;
border-radius:25px;
padding:20px;
box-shadow:0 25px 50px rgba(0,0,0,.1);
transition:.4s;
transform-style:preserve-3d;
}

.card:hover{
transform:rotateX(6deg) rotateY(-6deg) scale(1.05);
}

.card h4{margin:10px 0}

.actions a{
margin-right:10px;
}

.search{
padding:12px;
border-radius:12px;
border:none;
box-shadow:0 10px 25px rgba(0,0,0,.1);
width:250px;
}

</style>

<div class="dashboard">

<div class="topbar">
<h2>{{ course.title }}</h2>
<input class="search" id="search" placeholder="Search material...">
</div>

<div class="stats">
<div class="stat"><h2 id="total">{{ materials|length }}</h2><small>Total</small></div>
<div class="stat"><canvas id="chart"></canvas></div>
<div class="stat"><a href="{% url 'trainer_material_upload' course.id %}" class="btn btn-primary">Upload</a></div>
</div>

<div class="material-grid" id="grid">
{% for m in materials %}
<div class="card" data-title="{{ m.title }}">
<h4>{{ m.title }}</h4>
<small>ID : {{ m.id }}</small>
<p>{{ m.created_at|date:"d M Y" }}</p>

<div class="actions">
<a href="{{ m.file.url }}" target="_blank">View</a>
<a href="{% url 'trainer_material_delete' m.id %}">Delete</a>
</div>
</div>
{% endfor %}
</div>

</div>

<script>
const cards=[...document.querySelectorAll('.card')];
search.onkeyup=e=>{
cards.forEach(c=>{
c.style.display=c.dataset.title.toLowerCase().includes(e.target.value.toLowerCase())?'':'none';
});
}

new Chart(document.getElementById('chart'),{
type:'doughnut',
data:{
labels:['Materials'],
datasets:[{data:[{{ materials|length }}],backgroundColor:['#6366f1']}]
}
});
</script>

{% endblock %}
