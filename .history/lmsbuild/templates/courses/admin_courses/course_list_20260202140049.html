{% extends "accounts/admin/base.html" %}
{% block content %}

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>

<style>
:root {
    --neon-cyan:#00f3ff;
    --neon-lime:#ccff00;
    --deep-dark:#0f172a;
    --glass-bg:rgba(255,255,255,.03);
    --glass-border:1px solid rgba(255,255,255,.1);
    --text-dim:#94a3b8;
}

.dashboard-container{
    padding:30px;
    background:radial-gradient(circle at top right,#1e293b,#0f172a);
    min-height:100vh;
    border-radius:20px
}

.top-section{
    display:grid;
    grid-template-columns:2fr 1fr;
    gap:25px;
    margin-bottom:30px
}

.glass-card{
    background:var(--glass-bg);
    backdrop-filter:blur(15px);
    border-radius:24px;
    border:var(--glass-border);
    padding:30px;
    box-shadow:0 20px 40px rgba(0,0,0,.3);
    transition:.4s
}

.glass-card:hover{
    transform:translateY(-5px);
    border-color:rgba(0,243,255,.3)
}

.page-title{
    font-size:2.4rem;
    font-weight:700;
    background:linear-gradient(90deg,var(--neon-cyan),var(--neon-lime));
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
    margin:0
}

.header-controls{
    display:flex;
    gap:20px;
    margin-top:25px
}

.search-wrapper{position:relative;flex:1}

.search-wrapper input{
    width:100%;
    background:rgba(0,0,0,.4);
    border:1px solid rgba(255,255,255,.1);
    padding:14px 20px 14px 45px;
    border-radius:16px;
    color:#fff
}

.search-wrapper i{
    position:absolute;
    left:18px;
    top:50%;
    transform:translateY(-50%);
    color:var(--neon-cyan)
}

.btn-add{
    background:linear-gradient(135deg,var(--neon-cyan),#0099ff);
    color:#0f172a!important;
    padding:14px 30px;
    border-radius:16px;
    text-decoration:none;
    font-weight:700
}

.table-container{margin-top:20px}

table{width:100%;border-spacing:0 12px}

thead th{
    color:var(--text-dim);
    padding:10px 25px;
    text-align:left
}

tbody tr{
    background:rgba(255,255,255,.02);
    transition:.3s
}

tbody tr:hover{
    background:rgba(255,255,255,.07);
    box-shadow:-5px 0 0 var(--neon-cyan)
}

td{padding:20px 25px;color:#cbd5e1}

.level-beginner{color:#4ade80}
.level-intermediate{color:#facc15}
.level-advanced{color:#f87171}

.action-link{color:#94a3b8;font-size:1.2rem;margin-left:15px}
.del-link{color:#ff4d4d}
</style>

<div class="dashboard-container">

<div class="top-section">
<div class="glass-card">
<h2 class="page-title">Course Library</h2>

<div class="header-controls">
<div class="search-wrapper">
<i class="fas fa-search"></i>
<input type="text" id="courseSearch" placeholder="Search..." onkeyup="searchTable()">
</div>

<a href="{% url 'admin_course_create' %}" class="btn-add">
<i class="fas fa-plus"></i> New Course
</a>
</div>
</div>

<div class="glass-card">
<div id="courseChart" style="height:220px"></div>
</div>
</div>

<div class="table-container">
<table id="courseTable">
<thead>
<tr>
<th>Course</th>
<th>Trainer</th>
<th>Level</th>
<th>Duration</th>
<th style="text-align:right">Actions</th>
</tr>
</thead>

<tbody>
{% for c in courses %}
<tr>
<td>{{ c.title }}</td>
<td>{{ c.trainer.user.username }}</td>

<td class="level-cell" data-level="{{ c.level }}">
{% if c.level == "beginner" %}
<span class="level-beginner">Beginner</span>
{% elif c.level == "intermediate" %}
<span class="level-intermediate">Intermediate</span>
{% else %}
<span class="level-advanced">Advanced</span>
{% endif %}
</td>

<td>{{ c.duration }}</td>

<td style="text-align:right">

<!-- FIXED LINK -->
<a href="{% url 'admin_material_upload' c.id %}" class="action-link">
<i class="fa-solid fa-folder-tree"></i>
</a>

<a href="{% url 'admin_course_edit' c.id %}" class="action-link">
<i class="fa-solid fa-pen"></i>
</a>

<a href="{% url 'admin_course_delete' c.id %}" class="action-link del-link"
onclick="return confirm('Delete?')">
<i class="fa-solid fa-trash"></i>
</a>

</td>
</tr>
{% empty %}
<tr><td colspan="5" style="text-align:center">No Courses</td></tr>
{% endfor %}
</tbody>
</table>
</div>

</div>

<script>
function searchTable(){
let input=document.getElementById("courseSearch").value.toUpperCase();
let rows=document.querySelector("#courseTable tbody").rows;
for(let i=0;i<rows.length;i++){
rows[i].style.display=rows[i].cells[0].innerText.toUpperCase().includes(input)?"":"none";
}
}
</script>

{% endblock %}
