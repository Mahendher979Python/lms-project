{% extends "accounts/admin/base.html" %}
{% block content %}

<style>
/* ===== PAGE BASE ===== */
.page-wrap{
 max-width:900px;
 margin:30px auto;
 padding:20px;
 font-family:Segoe UI, sans-serif;
}

/* ===== CARD ===== */
.card{
 background:#ffffff;
 border-radius:12px;
 box-shadow:0 8px 30px rgba(0,0,0,.08);
 padding:30px;
}

/* ===== HEADER ===== */
.card-header{
 display:flex;
 justify-content:space-between;
 align-items:center;
 margin-bottom:25px;
 border-bottom:1px solid #e5e7eb;
 padding-bottom:15px;
}

.card-header h2{
 margin:0;
 font-size:1.4rem;
 color:#0f172a;
}

.close-btn{
 text-decoration:none;
 font-size:1.4rem;
 color:#64748b;
}
.close-btn:hover{color:#ef4444}

/* ===== FORM ===== */
label{
 display:block;
 margin-bottom:6px;
 font-size:.9rem;
 font-weight:600;
 color:#374151;
}

input, select, textarea{
 width:100%;
 padding:11px 12px;
 border-radius:8px;
 border:1px solid #d1d5db;
 margin-bottom:18px;
 font-size:.95rem;
}

input:focus, select:focus, textarea:focus{
 outline:none;
 border-color:#6366f1;
 box-shadow:0 0 0 3px rgba(99,102,241,.15);
}

/* GRID */
.grid-2{
 display:grid;
 grid-template-columns:1fr 1fr;
 gap:20px;
}

/* ===== ASSIGN USERS ===== */
.assign-box{
 border:1px solid #e5e7eb;
 border-radius:10px;
 padding:15px;
}

.assign-filters{
 display:flex;
 gap:20px;
 margin-bottom:12px;
 font-size:.9rem;
 color:#374151;
}

.users{
 display:grid;
 grid-template-columns:repeat(auto-fill,minmax(200px,1fr));
 gap:10px;
 max-height:220px;
 overflow:auto;
}

.users label{
 font-weight:500;
 color:#374151;
}

/* ===== BUTTONS ===== */
.actions{
 display:flex;
 justify-content:flex-end;
 gap:15px;
 margin-top:25px;
}

.btn{
 padding:10px 22px;
 border-radius:8px;
 border:none;
 cursor:pointer;
 font-weight:600;
 font-size:.95rem;
}

.btn-primary{
 background:#6366f1;
 color:white;
}
.btn-primary:hover{background:#4f46e5}

.btn-secondary{
 background:#f3f4f6;
 color:#374151;
 text-decoration:none;
}
.btn-secondary:hover{background:#e5e7eb}
</style>

<div class="page-wrap">

<div class="card">

<!-- HEADER -->
<div class="card-header">
<h2>➕ Create Note</h2>
<a href="{% url 'admin_notes_list' %}" class="close-btn" title="Close">✖</a>
</div>

<form method="POST" enctype="multipart/form-data">
{% csrf_token %}

<label>Note Title</label>
<input type="text" name="title" placeholder="Enter note title" required>

<div class="grid-2">
<div>
<label>Course</label>
<select name="course">
<option value="">-- Optional --</option>
{% for c in courses %}
<option value="{{c.id}}">{{c.title}}</option>
{% endfor %}
</select>
</div>

<div>
<label>Visibility</label>
<select name="visibility">
<option value="private">Private</option>
<option value="public">Public</option>
</select>
</div>
</div>

<label>Description</label>
<textarea name="description" rows="4"></textarea>

<label>Upload File</label>
<input type="file" name="file">

<label>Assign Users</label>
<div class="assign-box">

<div class="assign-filters">
<label><input type="checkbox" id="all"> All</label>
<label><input type="checkbox" id="trainers"> Trainers</label>
<label><input type="checkbox" id="students"> Students</label>
</div>

<div class="users">
{% for u in admins %}
<label><input type="checkbox" class="chk admin" name="assigned_to" value="{{u.id}}"> {{u.username}} (Admin)</label>
{% endfor %}
{% for u in trainers %}
<label><input type="checkbox" class="chk trainer" name="assigned_to" value="{{u.id}}"> {{u.username}} (Trainer)</label>
{% endfor %}
{% for u in students %}
<label><input type="checkbox" class="chk student" name="assigned_to" value="{{u.id}}"> {{u.username}} (Student)</label>
{% endfor %}
</div>

</div>

<!-- ACTIONS -->
<div class="actions">
<a href="{% url 'admin_notes_list' %}" class="btn btn-secondary">Cancel</a>
<button class="btn btn-primary">Save Note</button>
</div>

</form>
</div>
</div>

<script>
const all=document.getElementById("all");
const t=document.getElementById("trainers");
const s=document.getElementById("students");
const chk=document.querySelectorAll(".chk");

all.onchange=()=>chk.forEach(c=>c.checked=all.checked);
t.onchange=()=>document.querySelectorAll(".trainer").forEach(c=>c.checked=t.checked);
s.onchange=()=>document.querySelectorAll(".student").forEach(c=>c.checked=s.checked);
</script>

{% endblock %}
