{% extends 'accounts\trainer\base.html' %}


{% block title %}Trainer Dashboard | LMS{% endblock %}

{% block extra_css %}
<style>
    /* ===== Page Header ===== */
    .page-header { margin-bottom: 25px; }
    .page-header h2 { font-size: 24px; color: #1e293b; margin-bottom: 5px; }
    .page-header p { color: #64748b; font-size: 14px; }

    /* ===== Section Titles ===== */
    .section-title {
        font-size: 18px;
        font-weight: 600;
        color: #334155;
        margin: 30px 0 15px 0;
    }

    /* ===== Stats Cards (Colored) ===== */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }
    .stat-card {
        padding: 20px;
        border-radius: 12px;
        color: white;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }
    .stat-card h3 { font-size: 16px; font-weight: 500; margin-bottom: 10px; opacity: 0.9; }
    .stat-card p { font-size: 28px; font-weight: 700; margin: 0; }
    
    /* Gradients */
    .bg-blue { background: linear-gradient(135deg, #3b82f6, #1d4ed8); }
    .bg-green { background: linear-gradient(135deg, #22c55e, #15803d); }
    .bg-orange { background: linear-gradient(135deg, #f97316, #c2410c); }
    .bg-purple { background: linear-gradient(135deg, #8b5cf6, #6d28d9); }

    /* ===== Quick Action Cards (White) ===== */
    /* Inherits .cards and .card from base_trainer.html, adding specific tweaks */
    .action-card {
        text-align: center;
        transition: transform 0.2s;
        border: 1px solid #e2e8f0;
    }
    .action-card:hover { transform: translateY(-5px); border-color: #38bdf8; }
    .action-card i { font-size: 2rem; color: #38bdf8; margin-bottom: 15px; }

    /* ===== Search & Table ===== */
    .search-box { margin-bottom: 15px; display: flex; justify-content: flex-end; }
    .search-box input {
        width: 300px;
        padding: 10px 15px;
        border-radius: 20px;
        border: 1px solid #cbd5e1;
        outline: none;
    }
    .search-box input:focus { border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1); }

    .status-badge {
        padding: 5px 10px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
    }
    .status-active { background: #dcfce7; color: #166534; }
    .status-draft { background: #f1f5f9; color: #475569; }

</style>
{% endblock %}

{% block content %}

<div class="page-header">
    <h2>Dashboard Overview</h2>
    <p>Welcome back, <strong>{{ request.user.username }}</strong>! Here is what's happening today.</p>
</div>

<div class="stats-grid">
    <div class="stat-card bg-blue">
        <h3>üìò Total Courses</h3>
        <p>{{ courses_count|default:"0" }}</p>
    </div>

    <div class="stat-card bg-green">
        <h3>üìù Assignments</h3>
        <p>{{ assignments_count|default:"0" }}</p>
    </div>

    <div class="stat-card bg-orange">
        <h3>üì§ Submissions</h3>
        <p>{{ submissions_count|default:"0" }}</p>
    </div>

    <div class="stat-card bg-purple">
        <h3>üìä Attendance</h3>
        <p>{{ attendance_percentage|default:"0" }}%</p>
    </div>
</div>

<h3 class="section-title">‚ö° Quick Actions</h3>
<div class="cards">
    
    <div class="card action-card">
        <i class="fa-solid fa-video"></i>
        <h3>Manage Videos</h3>
        <p>Upload session recordings</p>
        <a href="{% url 'trainer_video_list' %}" class="btn">Go to Videos</a>
    </div>

    <div class="card action-card">
        <i class="fa-solid fa-image"></i>
        <h3>Manage Images</h3>
        <p>Posters & Ads</p>
        <a href="{% url 'trainer_ad_list' %}" class="btn">Go to Images</a>
    </div>

    <div class="card action-card">
        <i class="fa-solid fa-plus"></i>
        <h3>Add New Course</h3>
        <p>Create a new curriculum</p>
        <a href="{% url 'trainer_course_create' %}" class="btn">Create Course</a>
    </div>

</div>

<h3 class="section-title">üìÇ Recent Courses</h3>

<div class="search-box">
    <input type="text" id="searchInput" placeholder="üîç Search course name...">
</div>

<table id="courseTable">
    <thead>
        <tr>
            <th>Course Title</th>
            <th>Students</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for course in courses %}
        <tr>
            <td>
                <strong>{{ course.title }}</strong><br>
                <small style="color:#64748b">{{ course.level }}</small>
            </td>
            <td>0</td> <td>
                {% if course.is_published %}
                    <span class="status-badge status-active">Active</span>
                {% else %}
                    <span class="status-badge status-draft">Draft</span>
                {% endif %}
            </td>
            <td>
                <a href="{% url 'upload_course_pdf' course.id %}" style="color: #2563eb; margin-right: 10px;">
                    <i class="fa-solid fa-file-pdf"></i> PDF
                </a>
                <a href="{% url 'trainer_course_edit' course.id %}" style="color: #64748b;">
                    <i class="fa-solid fa-pen"></i> Edit
                </a>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="4" style="text-align:center; padding: 30px;">
                No courses found. <a href="{% url 'trainer_course_create' %}">Create one now?</a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}

{% block extra_js %}
<script>
    // Simple Client-side Search Script
    document.getElementById("searchInput").addEventListener("keyup", function() {
        let filter = this.value.toLowerCase();
        let rows = document.querySelectorAll("#courseTable tbody tr");
        
        rows.forEach(row => {
            let text = row.innerText.toLowerCase();
            row.style.display = text.includes(filter) ? "" : "none";
        });
    });
</script>
{% endblock %}