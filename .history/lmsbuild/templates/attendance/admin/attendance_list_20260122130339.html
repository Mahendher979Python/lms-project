{% extends "accounts/admin/base.html" %}
{% block content %}

<style>
.card{
  background:#fff;
  padding:25px;
  border-radius:16px;
  box-shadow:0 20px 45px rgba(0,0,0,.08);
}
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:20px;
}
.btn{
  padding:8px 16px;
  border-radius:8px;
  text-decoration:none;
  color:#fff;
  font-weight:600;
}
.add{background:#22c55e}
.edit{background:#2563eb}
.del{background:#dc2626}
table{
  width:100%;
  border-collapse:collapse;
}
th,td{
  padding:12px;
  text-align:center;
  border-bottom:1px solid #e5e7eb;
}
th{
  background:#f1f5f9;
}
.role-student{color:#16a34a;font-weight:700}
.role-trainer{color:#2563eb;font-weight:700}
.map{
  width:180px;
  height:120px;
  border-radius:10px;
  overflow:hidden;
}
iframe{width:100%;height:100%;border:0}
</style>

<div class="card">
  <div class="header">
    <h2>ðŸ“‹ Attendance â€“ Admin</h2>
    <a href="{% url 'admin_attendance_create' %}" class="btn add">+ Add Attendance</a>
  </div>

  <table>
    <tr>
      <th>User</th>
      <th>Role</th>
      <th>Date</th>
      <th>Login</th>
      <th>Logout</th>
      <th>Hours</th>
      <th>Location</th>
      <th>Marked By</th>
      <th>Actions</th>
    </tr>

    {% for a in attendance_list %}
    <tr>
      <td>{{a.user.username}}</td>
      <td>
        {% if a.role == "student" %}
          <span class="role-student">Student</span>
        {% else %}
          <span class="role-trainer">Trainer</span>
        {% endif %}
      </td>
      <td>{{a.date}}</td>
      <td>{{a.login_time|default:"-"}}</td>
      <td>{{a.logout_time|default:"-"}}</td>
      <td>{{a.total_work_hours|default:"00:00"}}</td>
      <td>
        {% if a.latitude %}
        <div class="map">
          <iframe src="https://maps.google.com/maps?q={{a.latitude}},{{a.longitude}}&z=14&output=embed"></iframe>
        </div>
        {% else %}-{% endif %}
      </td>
      <td>{{a.marked_by}}</td>
      <td>
        <a class="btn edit" href="{% url 'admin_attendance_edit' a.id %}">Edit</a>
        <a class="btn del" href="{% url 'admin_attendance_delete' a.id %}">Delete</a>
      </td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="9">No attendance records found</td>
    </tr>
    {% endfor %}
  </table>
</div>

{% endblock %}
